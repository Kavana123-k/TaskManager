<!Doctype html>
<html lang='en'>
<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">

    <style>
        .form-container {
            width: 1350px 10px;
            height: auto;
            padding: 50px 70px;
            background-color: #fff;
            border-radius: 70px 70px;
            margin: auto;
            box-shadow: 0 0 10px 0 #000;
            position: relative;
        }
    </style>
</head>
<BODY>
    <link rel="stylesheet" href="icons1/css/all.css"/>
    
    <nav class="navbar navbar-dark bg-primary navbar-expand-lg">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Task Manager</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>
    <div class="container-fluid">
        <div class="card">
            <div class="card-body">
                <TABLE class="table" id="dataTable">
                    <thead class="">
                        <tr class="table table-bordered">
                            <th> Name </th>
                            <th>Status</th>
                            <th> Description </th>
                            <th>Start Time</th>
                            <th>End Time </th>
                            <th>Edit</th>
                            <th>Delete</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </TABLE>
                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal" id="addTask" onclick="addTask"><i class="fas fa-plus"></i></button>
                </div>
                <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <h5 class="modal-title" id="exampleModalLabel">Task Details</h5>
                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="form-group">
                                        <label for="name">Task Name</label>
                                        <input type="text" class="form-control" id="name" placeholder="Enter Task Name">
                                    </div>
                                    <div class="form-group">
                                        <label for="status">Status</label>
                                        <input type="text" class="form-control" id="status" placeholder="Status">
                                    </div>
                                    <div class="form-group">
                                        <label for="description">Description</label>
                                        <input type="text" class="form-control" id="description" placeholder="Description"><br>
                                    </div>
                                    <div class="form-group">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="date">StartDate</label>
                                                    <input type="date" class="form-control" id="sdate">
                                                </div>
                                                <div class="col">
                                                    <label for="time">StartTime</label>
                                                    <input type="Time" class="form-control" id="stime" step="1">
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="container">
                                            <div class="row">
                                                <div class="col">
                                                    <label for="date">EndDate</label>
                                                    <input type="date" class="form-control" id="edate">
                                                </div>
                                                <div class="col">
                                                    <label for="time">EndTime</label>
                                                    <input type="Time" class="form-control" id="etime" step="1">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                            <div class="modal-footer">
                                <button type="Submit" class="btn btn-secondary" data-bs-dismiss="modal" id="submit" onclick="TaskDetails()">Submit</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
    <SCRIPT language="javascript">
        var url = "http://localhost:8090/api/Task/";
        //    var tasks = [{
        //    name: "Task1",
        //    discription: "discription1",
        //    startTime: "16/12/2020 01:01:01",
        //    endTime: "18/12/2020 01:01:01",
        //    status: "open"
        //},
        //{
        //    name: "Task2",
        //    discription: "discription2",
        //    startTime: "16/12/2020 02:02:02",
        //    endTime: "17/12/2020 23:23:23",
        //    status: "Inprogress"
        //},
        //{
        //    name: "Task3",
        //    discription: "discription3",
        //    startTime: "03/01/2020 04:01:01",
        //    endTime: "17/12/2020 01:01:01",
        //    status: "Onhold"
        //},
        //{
        //    name: "Task4",
        //    discription: "discription4",
        //    startTime: "04/01/2020 03:04:01",
        //    endTime: "16/12/2020 01:01:01",
        //    status: "Inprogress"
        //},
        //{
        //    name: "Task5",
        //    discription: "discription5",
        //    startTime: "05/01/2020 05:01:01",
        //    endTime: "17/12/2020 01:01:01",
        //    status: "Closed"
        //},
        //{
        //    name: "Task6",
        //    discription: "discription6",
        //    startTime: "06/01/2020 06:01:01",
        //    endTime: "01/12/2020 01:01:01",
        //    status: "Onhold"
        //},
        //{

        //    name: "Task7",
        //    discription: "discription7",
        //    startTime: "06/01/2020 03:01:01",
        //    endTime: "16/12/2020 23:23:23",
        //    status: "open"
        //},
        //{
        //    name: "Task8",
        //    discription: "discription8",
        //    startTime: "07/01/2020 01:01:01",
        //    endTime: "17/12/2020 01:01:01",
        //    status: "Closed"
        //},
        //{
        //    name: "Task9",
        //    discription: "discription9",
        //    startTime: "07/01/2020 01:01:01",
        //    endTime: "07/12/2020 01:01:01",
        //    status: "open"
        //},
        //{
        //    name: "Task10",
        //    discription: "discription10",
        //    startTime: "08/01/2020 01:01:01",
        //    endTime: "18/12/2020 02:01:01",
        //    status: "Inprogress"
        //}];

        var tasks=[];
        function TaskDetails() {
            var name = document.getElementById("name").value;
            var status = document.getElementById("status").value;
            var description = document.getElementById("description").value;
            var startdate = document.getElementById("sdate").value;
            var starttime = document.getElementById("stime").value;
            var enddate = document.getElementById("edate").value;
            var endtime = document.getElementById("etime").value;
            var obj = {
                name:name,
                status:status,
                description:description,
                startdate:startdate,
                starttime:starttime,
                enddate:enddate,
                endtime:endtime
            };
            //document.getElementById("submit").innerhtml=addTask(obj);
            //document.getElementById("submit").innerhtml =editTask(obj);
            //document.getElementById("submit").innerhtml =deleteTask(obj);
            //document.getElementById("submit").innerhtml =getAllTask(obj);
            //document.getElementById("submit").innerhtml =getTask(obj);
            addTask(obj);
            editTask(obj);
            deleteTask(obj);
            getAllTask(obj);
            getTask(obj);
        }

        var tableBody = document.querySelector('#dataTable tbody');
        if (tableBody) {
            for (var i = 0; i < tasks.length; i++) {
                var status;
                var today = new Date();
                var date = today.getDate() + '/' + (today.getMonth() + 1) + '/' + today.getFullYear();
                var time = today.getHours() + ':' + today.getMinutes() + ':' + today.getSeconds();
                var et = date + ' ' + time;
                var endtime1;
                console.log(tasks[i]);
                var task = tasks[i];
                if (task.status == 'open') {
                    status = '<span class="badge bg-warning text-dark">' + task.status + '</span>';
                }
                else if (task.status == 'Closed') {
                    status = '<span class="badge bg-success">' + task.status + '</span>';
                }
                else if (task.status == 'Inprogress') {
                    status = '<span class="badge bg-primary">' + task.status + '</span>';
                }
                else if (task.status == 'Onhold') {
                    status = '<span class="badge bg-secondary">' + task.status + '</span>';
                }
                else {
                    status = '<span class="badge bg-light text-dark">' + task.status + '</span>';
                }
                if (task.endTime < et) {
                    endtime1 = '<p style="color:red">' + task.endTime + '</p>';
                }
                else {
                    endtime1 = '<p style="color:black">' + task.endTime + '</p>';
                }
                tableBody.innerHTML += '<tr><td>' + task.name + '</td><td>' +
                    status
                    + '</td><td>' + task.discription + '</td><td>' + task.startTime + '</td><td>' + endtime1 + '</td><td>' + "<button type='button' class='btn btn-primary' data-bs-toggle='modal' data-bs-target='#exampleModal'  >" + "<i class='fas fa-edit'></i>" + "</button>" + '</td><td>' + "<button type='button' onclick='TaskDelete(this)' class='btn btn-primary'>" + "<i class='fas fa-trash'></i>" + "</button>" + '</td></tr>';
            }
        }


         function addTask(task) {
            const userAction = async () => {
                const response = await fetch((url + "Create"), {
                    method: 'POST',
                    body: JSON.stringify(task),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const myJson = await response.json();
                console.log(response);
                console.log(myJson);
            }
            var response = userAction();
        }

        function editTask(task) {
            const userAction = async () => {
                const response = await fetch((url + "Edit"), {
                    method: 'POST',
                    body: JSON.stringify(task),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const myJson = await response.json();
                console.log(response);
                console.log(myJson);
            }
            var response = userAction();
        }

        function deleteTask(task) {
            const userAction = async () => {
                const response = await fetch((url + "Delete"), {
                    method: 'POST',
                    body: JSON.stringify(task),
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                const myJson = await response.json();
                console.log(response);
                console.log(myJson);
            }
            var response = userAction();
        }

        function getAllTask(task) {
            const userAction = async () => {
                const response = await fetch((url + "GetAll"), {
                    headers: {
                        'Access-Control-Allow-Origin': '*'
                    }
                });
                const myJson = await response.json();
                console.log(response);
                console.log(myJson);
            }
            var response = userAction();
        }

        function getTask(task) {
            const userAction = async () => {
                const response = await fetch((url + "Get"), {
                    headers: {
                        'Access-Control-Allow-Origin': '*'
                    }
                });
                const myJson = await response.json();
                console.log(response);
                console.log(myJson);
            }
            var response = userAction();
        }

    </SCRIPT>
</BODY>
</html>